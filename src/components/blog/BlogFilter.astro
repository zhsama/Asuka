---
import { getAllTags, getAllCategories } from '@/utils/blog';
import '@/styles/components/blog-filter.css';

interface Props {
  currentTags?: string[];
  currentCategory?: string;
  currentYear?: number;
}

const { currentTags = [], currentCategory, currentYear } = Astro.props;

const tags = getAllTags();
const categories = getAllCategories();

// 获取年份列表
const currentYearNum = new Date().getFullYear();
const years = Array.from({ length: 5 }, (_, i) => currentYearNum - i);
---

<div class="filter-container">
  <div class="filter-section">
    <h3 class="filter-title">分类</h3>
    <div class="filter-list">
      <a 
        href="/blog" 
        class={`filter-link ${!currentCategory ? 'active' : ''}`}
      >
        全部
      </a>
      {categories.map(category => (
        <a 
          href={`/blog/category/${encodeURIComponent(category.name)}`}
          class={`filter-link ${currentCategory === category.name ? 'active' : ''}`}
        >
          {category.name} ({category.count})
        </a>
      ))}
    </div>
  </div>

  <div class="filter-section">
    <h3 class="filter-title">标签</h3>
    <div class="filter-tags">
      {tags.slice(0, 20).map(tag => (
        <a 
          href={`/blog/tag/${encodeURIComponent(tag.name)}`}
          class={`filter-tag ${currentTags.includes(tag.name) ? 'active' : ''}`}
          style={`font-size: ${Math.min(1.2, 0.8 + (tag.count / 10))}rem;`}
        >
          #{tag.name}
        </a>
      ))}
    </div>
  </div>

  <div class="filter-section">
    <h3 class="filter-title">年份</h3>
    <div class="filter-list">
      <a 
        href="/blog" 
        class={`filter-link ${!currentYear ? 'active' : ''}`}
      >
        全部
      </a>
      {years.map(year => (
        <a 
          href={`/blog/year/${year}`}
          class={`filter-link ${currentYear === year ? 'active' : ''}`}
        >
          {year}
        </a>
      ))}
    </div>
  </div>

  <div class="filter-section">
    <h3 class="filter-title">快速导航</h3>
    <div class="filter-list">
      <a href="/blog" class="filter-link">
        📝 最新文章
      </a>
      <a href="/blog/featured" class="filter-link">
        ⭐ 精选文章
      </a>
      <a href="/blog/archive" class="filter-link">
        📚 文章归档
      </a>
      <a href="/blog/friends" class="filter-link">
        🔗 友情链接
      </a>
    </div>
  </div>
</div>